import json

import sqlite3

data = [{"name": "Albert Einstein", "born": "March 14, 1879 in Ulm, Germany", "reference": "http://quotes.toscrape.com/author/Albert-Einstein/"}, {"name": "J.K. Rowling", "born": "July 31, 1965 in Yate, South Gloucestershire, England, The United Kingdom", "reference": "http://quotes.toscrape.com/author/J-K-Rowling/"}, {"name": "Albert Einstein", "born": "March 14, 1879 in Ulm, Germany", "reference": "http://quotes.toscrape.com/author/Albert-Einstein/"}, {"name": "Jane Austen", "born": "December 16, 1775 in Steventon Rectory, Hampshire, The United Kingdom", "reference": "http://quotes.toscrape.com/author/Jane-Austen/"}, {"name": "Marilyn Monroe", "born": "June 01, 1926 in The United States", "reference": "http://quotes.toscrape.com/author/Marilyn-Monroe/"}, {"name": "Albert Einstein", "born": "March 14, 1879 in Ulm, Germany", "reference": "http://quotes.toscrape.com/author/Albert-Einstein/"}, {"name": "Andr\u00e9 Gide", "born": "November 22, 1869 in Paris, France", "reference": "http://quotes.toscrape.com/author/Andre-Gide/"}, {"name": "Thomas A. Edison", "born": "February 11, 1847 in Milan, Ohio, The United States", "reference": "http://quotes.toscrape.com/author/Thomas-A-Edison/"}, {"name": "Eleanor Roosevelt", "born": "October 11, 1884 in The United States", "reference": "http://quotes.toscrape.com/author/Eleanor-Roosevelt/"}, {"name": "Steve Martin", "born": "August 14, 1945 in Waco, Texas, The United States", "reference": "http://quotes.toscrape.com/author/Steve-Martin/"}, {"name": "Marilyn Monroe", "born": "June 01, 1926 in The United States", "reference": "http://quotes.toscrape.com/author/Marilyn-Monroe/"}, {"name": "J.K. Rowling", "born": "July 31, 1965 in Yate, South Gloucestershire, England, The United Kingdom", "reference": "http://quotes.toscrape.com/author/J-K-Rowling/"}, {"name": "Albert Einstein", "born": "March 14, 1879 in Ulm, Germany", "reference": "http://quotes.toscrape.com/author/Albert-Einstein/"}, {"name": "Bob Marley", "born": "February 06, 1945 in Nine Mile, Saint Ann, Jamaica", "reference": "http://quotes.toscrape.com/author/Bob-Marley/"}, {"name": "Dr. Seuss", "born": "March 02, 1904 in Springfield, MA, The United States", "reference": "http://quotes.toscrape.com/author/Dr-Seuss/"}, {"name": "Douglas Adams", "born": "March 11, 1952 in Cambridge, England, The United Kingdom", "reference": "http://quotes.toscrape.com/author/Douglas-Adams/"}, {"name": "Elie Wiesel", "born": "September 30, 1928 in Sighet, Romania", "reference": "http://quotes.toscrape.com/author/Elie-Wiesel/"}, {"name": "Friedrich Nietzsche", "born": "October 15, 1844 in R\u00f6cken bei L\u00fctzen, Prussian Province of Saxony, Germany", "reference": "http://quotes.toscrape.com/author/Friedrich-Nietzsche/"}, {"name": "Mark Twain", "born": "November 30, 1835 in Florida, Missouri, The United States", "reference": "http://quotes.toscrape.com/author/Mark-Twain/"}, {"name": "Allen Saunders", "born": "April 24, 1899 in The United States", "reference": "http://quotes.toscrape.com/author/Allen-Saunders/"}, {"name": "Pablo Neruda", "born": "July 12, 1904 in Parral, Chile", "reference": "http://quotes.toscrape.com/author/Pablo-Neruda/"}, {"name": "Ralph Waldo Emerson", "born": "May 25, 1803 in Boston, Massachusetts, The United States", "reference": "http://quotes.toscrape.com/author/Ralph-Waldo-Emerson/"}, {"name": "Mother Teresa", "born": "August 26, 1910 in Skopje, Macedonia, the Former Yugoslav Republic of", "reference": "http://quotes.toscrape.com/author/Mother-Teresa/"}, {"name": "Garrison Keillor", "born": "August 07, 1942 in Anoka, Minnesota, The United States", "reference": "http://quotes.toscrape.com/author/Garrison-Keillor/"}, {"name": "Jim Henson", "born": "September 24, 1936 in Greenville, Mississippi, The United States", "reference": "http://quotes.toscrape.com/author/Jim-Henson/"}, {"name": "Dr. Seuss", "born": "March 02, 1904 in Springfield, MA, The United States", "reference": "http://quotes.toscrape.com/author/Dr-Seuss/"}, {"name": "Albert Einstein", "born": "March 14, 1879 in Ulm, Germany", "reference": "http://quotes.toscrape.com/author/Albert-Einstein/"}, {"name": "J.K. Rowling", "born": "July 31, 1965 in Yate, South Gloucestershire, England, The United Kingdom", "reference": "http://quotes.toscrape.com/author/J-K-Rowling/"}, {"name": "Albert Einstein", "born": "March 14, 1879 in Ulm, Germany", "reference": "http://quotes.toscrape.com/author/Albert-Einstein/"}, {"name": "Bob Marley", "born": "February 06, 1945 in Nine Mile, Saint Ann, Jamaica", "reference": "http://quotes.toscrape.com/author/Bob-Marley/"}, {"name": "Dr. Seuss", "born": "March 02, 1904 in Springfield, MA, The United States", "reference": "http://quotes.toscrape.com/author/Dr-Seuss/"}, {"name": "J.K. Rowling", "born": "July 31, 1965 in Yate, South Gloucestershire, England, The United Kingdom", "reference": "http://quotes.toscrape.com/author/J-K-Rowling/"}, {"name": "Bob Marley", "born": "February 06, 1945 in Nine Mile, Saint Ann, Jamaica", "reference": "http://quotes.toscrape.com/author/Bob-Marley/"}, {"name": "Mother Teresa", "born": "August 26, 1910 in Skopje, Macedonia, the Former Yugoslav Republic of", "reference": "http://quotes.toscrape.com/author/Mother-Teresa/"}, {"name": "J.K. Rowling", "born": "July 31, 1965 in Yate, South Gloucestershire, England, The United Kingdom", "reference": "http://quotes.toscrape.com/author/J-K-Rowling/"}, {"name": "Charles M. Schulz", "born": "November 26, 1922 in Minneapolis, MN, The United States", "reference": "http://quotes.toscrape.com/author/Charles-M-Schulz/"}, {"name": "William Nicholson", "born": "January 12, 1948 in Lewes, Sussex, The United Kingdom", "reference": "http://quotes.toscrape.com/author/William-Nicholson/"}, {"name": "Albert Einstein", "born": "March 14, 1879 in Ulm, Germany", "reference": "http://quotes.toscrape.com/author/Albert-Einstein/"}, {"name": "Jorge Luis Borges", "born": "August 24, 1899 in Buenos Aires, Argentina", "reference": "http://quotes.toscrape.com/author/Jorge-Luis-Borges/"}, {"name": "George Eliot", "born": "November 22, 1819 in South Farm, Arbury Hall, Nuneaton, Warwickshire, The United Kingdom", "reference": "http://quotes.toscrape.com/author/George-Eliot/"}, {"name": "George R.R. Martin", "born": "September 20, 1948 in Bayonne, New Jersey, The United States", "reference": "http://quotes.toscrape.com/author/George-R-R-Martin/"}, {"name": "C.S. Lewis", "born": "November 29, 1898 in Belfast, Ireland", "reference": "http://quotes.toscrape.com/author/C-S-Lewis/"}, {"name": "Marilyn Monroe", "born": "June 01, 1926 in The United States", "reference": "http://quotes.toscrape.com/author/Marilyn-Monroe/"}, {"name": "Marilyn Monroe", "born": "June 01, 1926 in The United States", "reference": "http://quotes.toscrape.com/author/Marilyn-Monroe/"}, {"name": "Albert Einstein", "born": "March 14, 1879 in Ulm, Germany", "reference": "http://quotes.toscrape.com/author/Albert-Einstein/"}, {"name": "Marilyn Monroe", "born": "June 01, 1926 in The United States", "reference": "http://quotes.toscrape.com/author/Marilyn-Monroe/"}, {"name": "Marilyn Monroe", "born": "June 01, 1926 in The United States", "reference": "http://quotes.toscrape.com/author/Marilyn-Monroe/"}, {"name": "Martin Luther King Jr.", "born": "January 15, 1929 in Atlanta, Georgia, The United States", "reference": "http://quotes.toscrape.com/author/Martin-Luther-King-Jr/"}, {"name": "J.K. Rowling", "born": "July 31, 1965 in Yate, South Gloucestershire, England, The United Kingdom", "reference": "http://quotes.toscrape.com/author/J-K-Rowling/"}, {"name": "James Baldwin", "born": "August 02, 1924 in Harlem, New York, The United States", "reference": "http://quotes.toscrape.com/author/James-Baldwin/"}, {"name": "Jane Austen", "born": "December 16, 1775 in Steventon Rectory, Hampshire, The United Kingdom", "reference": "http://quotes.toscrape.com/author/Jane-Austen/"}, {"name": "Eleanor Roosevelt", "born": "October 11, 1884 in The United States", "reference": "http://quotes.toscrape.com/author/Eleanor-Roosevelt/"}, {"name": "Marilyn Monroe", "born": "June 01, 1926 in The United States", "reference": "http://quotes.toscrape.com/author/Marilyn-Monroe/"}, {"name": "Albert Einstein", "born": "March 14, 1879 in Ulm, Germany", "reference": "http://quotes.toscrape.com/author/Albert-Einstein/"}, {"name": "Haruki Murakami", "born": "January 12, 1949 in Kyoto, Japan", "reference": "http://quotes.toscrape.com/author/Haruki-Murakami/"}, {"name": "Alexandre Dumas fils", "born": "July 27, 1824 in Paris, France", "reference": "http://quotes.toscrape.com/author/Alexandre-Dumas-fils/"}, {"name": "Stephenie Meyer", "born": "December 24, 1973 in Connecticut, The United States", "reference": "http://quotes.toscrape.com/author/Stephenie-Meyer/"}, {"name": "Ernest Hemingway", "born": "July 21, 1899 in Oak Park, Illinois, The United States", "reference": "http://quotes.toscrape.com/author/Ernest-Hemingway/"}, {"name": "Helen Keller", "born": "June 27, 1880 in Tuscumbia, Alabama, The United States", "reference": "http://quotes.toscrape.com/author/Helen-Keller/"}, {"name": "George Bernard Shaw", "born": "July 26, 1856 in Dublin, Ireland", "reference": "http://quotes.toscrape.com/author/George-Bernard-Shaw/"}, {"name": "Charles Bukowski", "born": "August 16, 1920 in Andernach, Germany", "reference": "http://quotes.toscrape.com/author/Charles-Bukowski/"}, {"name": "Suzanne Collins", "born": "August 11, 1962 in Hartford, Connecticut, The United States", "reference": "http://quotes.toscrape.com/author/Suzanne-Collins/"}, {"name": "Suzanne Collins", "born": "August 11, 1962 in Hartford, Connecticut, The United States", "reference": "http://quotes.toscrape.com/author/Suzanne-Collins/"}, {"name": "C.S. Lewis", "born": "November 29, 1898 in Belfast, Ireland", "reference": "http://quotes.toscrape.com/author/C-S-Lewis/"}, {"name": "J.R.R. Tolkien", "born": "January 03, 1892 in Bloemfontein, Mangaung, Free State, South Africa", "reference": "http://quotes.toscrape.com/author/J-R-R-Tolkien/"}, {"name": "J.K. Rowling", "born": "July 31, 1965 in Yate, South Gloucestershire, England, The United Kingdom", "reference": "http://quotes.toscrape.com/author/J-K-Rowling/"}, {"name": "Ernest Hemingway", "born": "July 21, 1899 in Oak Park, Illinois, The United States", "reference": "http://quotes.toscrape.com/author/Ernest-Hemingway/"}, {"name": "Ralph Waldo Emerson", "born": "May 25, 1803 in Boston, Massachusetts, The United States", "reference": "http://quotes.toscrape.com/author/Ralph-Waldo-Emerson/"}, {"name": "Mark Twain", "born": "November 30, 1835 in Florida, Missouri, The United States", "reference": "http://quotes.toscrape.com/author/Mark-Twain/"}, {"name": "Dr. Seuss", "born": "March 02, 1904 in Springfield, MA, The United States", "reference": "http://quotes.toscrape.com/author/Dr-Seuss/"}, {"name": "Alfred Tennyson", "born": "August 06, 1809 in Somersby, Lincolnshire, The United Kingdom", "reference": "http://quotes.toscrape.com/author/Alfred-Tennyson/"}, {"name": "Charles Bukowski", "born": "August 16, 1920 in Andernach, Germany", "reference": "http://quotes.toscrape.com/author/Charles-Bukowski/"}, {"name": "Terry Pratchett", "born": "April 28, 1948 in Beaconsfield, Buckinghamshire, England, The United Kingdom", "reference": "http://quotes.toscrape.com/author/Terry-Pratchett/"}, {"name": "Dr. Seuss", "born": "March 02, 1904 in Springfield, MA, The United States", "reference": "http://quotes.toscrape.com/author/Dr-Seuss/"}, {"name": "J.D. Salinger", "born": "January 01, 1919 in Manhattan, New York, The United States", "reference": "http://quotes.toscrape.com/author/J-D-Salinger/"}, {"name": "George Carlin", "born": "May 12, 1937 in New York, New York, The United States", "reference": "http://quotes.toscrape.com/author/George-Carlin/"}, {"name": "John Lennon", "born": "October 09, 1940 in Liverpool, England, The United Kingdom", "reference": "http://quotes.toscrape.com/author/John-Lennon/"}, {"name": "W.C. Fields", "born": "January 29, 1880 in Darby, Pennsylvania, The United States", "reference": "http://quotes.toscrape.com/author/W-C-Fields/"}, {"name": "Ayn Rand", "born": "February 02, 1905 in St. Petersburg, Russian Federation", "reference": "http://quotes.toscrape.com/author/Ayn-Rand/"}, {"name": "Mark Twain", "born": "November 30, 1835 in Florida, Missouri, The United States", "reference": "http://quotes.toscrape.com/author/Mark-Twain/"}, {"name": "Albert Einstein", "born": "March 14, 1879 in Ulm, Germany", "reference": "http://quotes.toscrape.com/author/Albert-Einstein/"}, {"name": "Jane Austen", "born": "December 16, 1775 in Steventon Rectory, Hampshire, The United Kingdom", "reference": "http://quotes.toscrape.com/author/Jane-Austen/"}, {"name": "J.K. Rowling", "born": "July 31, 1965 in Yate, South Gloucestershire, England, The United Kingdom", "reference": "http://quotes.toscrape.com/author/J-K-Rowling/"}, {"name": "Jane Austen", "born": "December 16, 1775 in Steventon Rectory, Hampshire, The United Kingdom", "reference": "http://quotes.toscrape.com/author/Jane-Austen/"}, {"name": "Jane Austen", "born": "December 16, 1775 in Steventon Rectory, Hampshire, The United Kingdom", "reference": "http://quotes.toscrape.com/author/Jane-Austen/"}, {"name": "C.S. Lewis", "born": "November 29, 1898 in Belfast, Ireland", "reference": "http://quotes.toscrape.com/author/C-S-Lewis/"}, {"name": "C.S. Lewis", "born": "November 29, 1898 in Belfast, Ireland", "reference": "http://quotes.toscrape.com/author/C-S-Lewis/"}, {"name": "Mark Twain", "born": "November 30, 1835 in Florida, Missouri, The United States", "reference": "http://quotes.toscrape.com/author/Mark-Twain/"}, {"name": "Mark Twain", "born": "November 30, 1835 in Florida, Missouri, The United States", "reference": "http://quotes.toscrape.com/author/Mark-Twain/"}, {"name": "C.S. Lewis", "born": "November 29, 1898 in Belfast, Ireland", "reference": "http://quotes.toscrape.com/author/C-S-Lewis/"}, {"name": "J.K. Rowling", "born": "July 31, 1965 in Yate, South Gloucestershire, England, The United Kingdom", "reference": "http://quotes.toscrape.com/author/J-K-Rowling/"}, {"name": "Jimi Hendrix", "born": "November 27, 1942 in Seattle, Washington, The United States", "reference": "http://quotes.toscrape.com/author/Jimi-Hendrix/"}, {"name": "J.M. Barrie", "born": "May 09, 1860 in Kirriemuir, Angus, Scotland, The United Kingdom", "reference": "http://quotes.toscrape.com/author/J-M-Barrie/"}, {"name": "E.E. Cummings", "born": "October 14, 1894 in Cambridge, Massachusetts, The United States", "reference": "http://quotes.toscrape.com/author/E-E-Cummings/"}, {"name": "Khaled Hosseini", "born": "March 04, 1965 in Kabul, Afghanistan", "reference": "http://quotes.toscrape.com/author/Khaled-Hosseini/"}, {"name": "Harper Lee", "born": "April 28, 1926 in Monroeville, Alabama, The United States", "reference": "http://quotes.toscrape.com/author/Harper-Lee/"}, {"name": "Madeleine L'Engle", "born": "November 29, 1918 in New York City, New York, The United States", "reference": "http://quotes.toscrape.com/author/Madeleine-LEngle/"}, {"name": "Mark Twain", "born": "November 30, 1835 in Florida, Missouri, The United States", "reference": "http://quotes.toscrape.com/author/Mark-Twain/"}, {"name": "Dr. Seuss", "born": "March 02, 1904 in Springfield, MA, The United States", "reference": "http://quotes.toscrape.com/author/Dr-Seuss/"}, {"name": "George R.R. Martin", "born": "September 20, 1948 in Bayonne, New Jersey, The United States", "reference": "http://quotes.toscrape.com/author/George-R-R-Martin/"}]

new_list = []
author_list = []
for i in data:
    new_dict = {}
    if i['name'] not in new_list:
        new_list.append(i['name'])
        new_dict['name'] = i['name']
        new_dict['born'] = i['born']
        new_dict['reference'] = i['reference']
        author_list.append(new_dict)


try:
    connection = sqlite3.connect("quotes.db")
    cursor = connection.cursor()
    cursor.executescript('''
        DROP TABLE IF EXISTS author;
    ''')
    cursor.executescript('''PRAGMA foreign_keys = ON''')
    cursor.executescript('''
        CREATE TABLE author(
            id INTEGER NOT NULL PRIMARY KEY,
            author_name VARCHAR(250),
            born TEXT,
            reference TEXT
            );
        
    ''')
    cursor.executescript('''
        INSERT INTO 
            author(id,author_name,born,reference)
            VALUES
                (2,'Khaled Hosseini','March 04, 1965 
                in Kabul, Afghanistan',
                'http://quotes.toscrape.com/author/Khaled-Hosseini/');
        ''')
    result = cursor.fetchall()
    print(result)
    
    cursor.close()

except sqlite3.Error as error:
    print("Error occured at {}".format(error))
finally:
    if connection:
        connection.close()

